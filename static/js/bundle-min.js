function mainFunc(){var e=new App;e.init()}var App=function(){this.counter=0,this.init=function(){var e=this;this.addRow(!1),$("#add-task-button").on("click",function(){e.addRow(!0)}),$("#show-timeline-button").on("click",function(){e.post()}),$("#color-picker-border-1,#color-picker-fill-1").colorpicker({format:"hex"}),$("#color-picker-border-2,#color-picker-fill-2").colorpicker({format:"hex"}),$("#datepicker-end").datepicker({format:"yyyy-mm-dd"}),$("#source-div").css({display:"none"}),$("#modal-action-button").on("click",function(){e.import()}),this.addTableButtonHandlers(),this.clipboard=new Clipboard("#copy-button"),this.clipboard.on("error",function(e){}),$("#import-modal").on("shown.bs.modal",function(){$("#modal-source").focus()})},this.addTableButtonHandlers=function(){for(var e=this,t=["up-button","down-button","delete-button"],o=0;o<t.length;o++)$("."+t[o]).unbind("click");$(".up-button").on("click",function(){e.up(this.id)}),$(".down-button").on("click",function(){e.down(this.id)}),$(".delete-button").on("click",function(){e.delete(this.id)})},this.addRow=function(e){return this.counter++,$("#task-table-body").append('<tr class="task" id="task-'+this.counter+'"><td><div class="input-append date"><input class="form-control" id="datepicker-start-'+this.counter+'" size="16" type="text" readonly><span class="add-on"><i class="icon-th"></i></span></div></td><td><div class="input-append date"><input class="form-control" id="datepicker-end-'+this.counter+'" size="16" type="text" readonly><span class="add-on"><i class="icon-th"></i></span></td><td><div class="checkbox"><label><input id="datepicker-end-'+this.counter+'-ongoing" type="checkbox">&nbsp;Ongoing</label></div></td><td><input class="form-control" id="label-'+this.counter+'" type="text"></td><td><button class="up-button btn btn-default" id="up-button-'+this.counter+'">&uarr;</button></td><td><button class="down-button btn btn-default" id="down-button-'+this.counter+'">&darr;</button></td><td><button class="delete-button btn btn-default" id="delete-button-'+this.counter+'">&cross;</button></td></tr>'),$("#datepicker-start-"+this.counter+",#datepicker-end-"+this.counter).datepicker({format:"yyyy-mm-dd"}),e&&$("#datepicker-start-"+this.counter).focus(),this.addTableButtonHandlers(),this.counter},this.serialize=function(){for(var e={settings:{},tasks:[],theme:{frameBorderColor:"#ffffff",frameFillColor:"#888888",stripeColorDark:"#dddddd",stripeColorLight:"#eeeeee",gridColor:"#999999"}},t=$(".task"),o=0;o<t.length;o++){var r=t[o],i=r.id,n=i.replace(/^task-/,""),a=$("#datepicker-start-"+n).datepicker("getFormattedDate"),d=$("#datepicker-end-"+n).datepicker("getFormattedDate"),c=$("#datepicker-end-"+n+"-ongoing").prop("checked");c&&(d="-");var l=$("#label-"+n).val(),s={};s.start=a,s.end=d,s.label=l,e.tasks.push(s)}e.settings.end=$("#datepicker-end").datepicker("getFormattedDate");var u=$("#datepicker-end-ongoing").prop("checked");return u&&(e.settings.end="-"),e.settings.zoom=Number($("#zoom-input").val()),e.settings.hideDaysFrom=Number($("#hide-days-from-input").val()),e.settings.hideWeeksFrom=Number($("#hide-weeks-from-input").val()),e.theme.colorScheme=$("#color-scheme-select").val(),e.theme.borderColor1=$("#color-picker-border-1").colorpicker("getValue","#ffffff"),e.theme.fillColor1=$("#color-picker-fill-1").colorpicker("getValue","#ffffff"),e.theme.borderColor2=$("#color-picker-border-2").colorpicker("getValue","#ffffff"),e.theme.fillColor2=$("#color-picker-fill-2").colorpicker("getValue","#ffffff"),JSON.stringify(e)},this.post=function(){var e=this.serialize();$.post("/timeline",e,function(t){return $("#result").html(t),0===e.length?void $("#source-div").css({display:"none"}):($("#source-div").css({display:"block"}),void($("#source")[0].value=e))})},this.up=function(e){var t=e.replace(/^up-button/,"#task");$(t).prev().before($(t)),this.addTableButtonHandlers()},this.down=function(e){var t=e.replace(/^down-button/,"#task");$(t).next().after($(t)),this.addTableButtonHandlers()},this.delete=function(e){var t=e.replace(/^delete-button/,"#task");$(t).remove(),this.addTableButtonHandlers()},this.import=function(){var e=$("#modal-source")[0].value;try{var t=JSON.parse(e)}catch(e){return void($("#result")[0].innerHTML=e.message)}if(t!=={}&&null!==t&&"undefined"!=typeof t||($("#result")[0].innerHTML="No timeline data found"),this.clearTasks(),t.tasks)for(var o=0;o<t.tasks.length;o++){var r=t.tasks[o],i=this.addRow(!1);$("#datepicker-start-"+i).datepicker("update",r.start);var n="-"===r.end;$("#datepicker-end-"+i).datepicker("update",n?"":r.end),$("#datepicker-end-"+i+"-ongoing").prop("checked",n),$("#label-"+i).val(r.label)}if(t.settings){var a=t.settings,n="-"===a.end;$("#datepicker-end").datepicker("update",n?"":a.end),$("#datepicker-end-ongoing").prop("checked",n),$("#zoom-input").val(a.zoom),$("#hide-days-from-input").val(a.hideDaysFrom),$("#hide-weeks-from-input").val(a.hideWeeksFrom)}if(t.theme){var d=t.theme;$("#color-scheme-select").val(d.colorScheme),$("#color-picker-border-1").colorpicker("setValue",d.borderColor1),$("#color-picker-fill-1").colorpicker("setValue",d.fillColor1),$("#color-picker-border-2").colorpicker("setValue",d.borderColor2),$("#color-picker-fill-2").colorpicker("setValue",d.fillColor2)}},this.clearTasks=function(){$("#task-table-body")[0].innerHTML=""}};window.onload=mainFunc;